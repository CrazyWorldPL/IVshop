{% extends 'base.html' %}
{% block body %}
    <div class="container">
        <div class="text-center">
            <h2>{{ server_name }}</h2>
            <a href="/shop/{{ server_id }}">sklep</a>
        </div>
        <div class="statistics" style="display: flex;">
           <div class="card" style="width: 10rem">
               <div class="text-center">
                   <div class="card-header">
                       Ilość produktów
                   </div>
                  <div class="card-body">
                      <b>{{ counted_products }}</b>
                  </div>
               </div>
            </div>
            <div class="card" style="width: 10rem">
               <div class="text-center">
                   <div class="card-header">
                       Kupione produkty
                   </div>
                  <div class="card-body">
                      <b>{{ purchases_count }}</b>
                  </div>
               </div>
            </div>
        </div>
        <div class="alert alert-light" role="alert">
            <div class="text-center" style="width: 100%;">
                <a href="" data-toggle="modal" data-target="#addProductModal">Dodaj nową usługę</a>
            </div>
        </div>
        <div class="alert alert-light" role="alert">
            <div class="text-center">
                <a href="" data-toggle="modal" data-target="#paymentsHistoryModal">Lista zakupów</a>
            </div>
        </div>
        <div class="alert alert-light" role="alert">
            <div class="text-center">
                <a href="" data-toggle="modal" data-target="#settingsModal">Operator płatności</a>
            </div>
        </div>
        <div class="alert alert-light" role="alert">
            <div class="text-center">
                <a href="" data-toggle="modal" data-target="#settings2Modal">Ustawienia</a>
            </div>
        </div>
    </div>
    <!-- Settings modal -->
    <div class="modal fade" id="settingsModal" tabindex="-1" role="dialog" aria-labelledby="settingsModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="settingsModalLabel">Operator płatności</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
              <div class="form-group col-md-6">
                  <label for="select_payment_type">Operator</label>
                  <select class="custom-select" id="select_payment_type">
                    <option value="1" >Lvlup</option>
                  </select>
                  <input type="hidden" value="{{ server_id }}" id="server_id">
                  <label for="lvlup_client_id" class="col-form-label">ID klienta</label>
                  <input type="number" name="lvlup_client_id" class="form-control select_payment_type" id="lvlup_client_id" value="{{ client_id }}">
                  <label for="lvlup_api_key" class="col-form-label">Klucz api</label>
                  <input type="text" name="lvlup_api_key" class="form-control select_payment_type" id="lvlup_api_key">
              </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Anuluj</button>
            <button type="button" class="btn btn-primary save-settings">Zapisz</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Add product modal -->
    <div class="modal fade" id="addProductModal" tabindex="-1" role="dialog" aria-labelledby="addProductModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addProductModalLabel">Dodaj produkt</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
              <div class="form-group col-md-6">
                  <label for="product_name" class="col-form-label">Nazwa produktu</label>
                  <input type="text" name="product_name" class="form-control add_product" id="product_name">
                  <label for="product_description" class="col-form-label">Opis produktu</label>
                  <textarea name="product_description" class="form-control add_product" id="product_description"></textarea>
                  <label for="product_price" class="col-form-label">Cena</label>
                  <input type="number" name="product_price" class="form-control add_product" id="product_price" placeholder="Format: 10.00">
                  <label for="product_sms_price">Cena SMS</label>
                  <select class="custom-select" id="product_sms_price">
                      <option value="70068">0,62 PLN</option>
                      <option value="7168">1,23 PLN</option>
                      <option value="72068">2,46 PLN</option>
                      <option value="73068">3,69 PLN</option>
                      <option value="74068">4,92 PLN</option>
                      <option value="75068">6,15 PLN</option>
                      <option value="76068">7,38 PLN</option>
                      <option value="79068">11,07 PLN</option>
                      <option value="91068">12,30 PLN</option>
                      <option value="91758">20,91 PLN</option>
                      <option value="92578">30,75 PLN</option>
                  </select>
                  <label for="product_commands" class="col-form-label">Komendy</label>
                  <textarea name="product_commands" class="form-control add_product" id="product_commands"></textarea>
                  <label for="product_commands" class="col-form-label" style="width: 200%;"><p>Komendy oddzielaj <b>średnikami</b>. Nick gracza to <b>{PLAYER}</b>.</p></label>
              </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Anuluj</button>
            <button type="button" class="btn btn-primary add_product_button">Dodaj</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Payments history modal -->
    <div class="modal fade" id="paymentsHistoryModal" tabindex="-1" role="dialog" aria-labelledby="paymentsHistoryModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="paymentsHistoryModalLabel">Lista zakupów</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <table class="table">
                <thead class="thead-light">
                  <tr>
                    <th>Produkt</th>
                    <th>Kupiec</th>
                    <th>Status</th>
                    <th>Data</th>
                  </tr>
                </thead>
                <tbody>
                  {% for purchase in purchases %}
                      <tr>
                        <td>{{ purchase.product.product_name }}</td>
                        <td>{{ purchase.buyer }}</td>
                        <td>
                            {% if purchase.status == 0 %}
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                  <path fill-rule="evenodd" d="M11.854 4.146a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708 0z"/>
                                  <path fill-rule="evenodd" d="M4.146 4.146a.5.5 0 0 0 0 .708l7 7a.5.5 0 0 0 .708-.708l-7-7a.5.5 0 0 0-.708 0z"/>
                                </svg>
                            {% else %}
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-check2" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                  <path fill-rule="evenodd" d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
                                </svg>
                            {% endif %}
                        </td>
                        <td>
                            {{ purchase.date|date:"d.m.Y" }} {{ purchase.date|time:"H:i" }}
                        </td>
                      </tr>
                  {% endfor %}
                </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Zamknij</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Settings2 modal -->
    <div class="modal fade" id="settings2Modal" tabindex="-1" role="dialog" aria-labelledby="settings2ModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="settings2ModalLabel">Ustawienia</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
              <div class="form-group col-md-6">
                  <input type="hidden" value="{{ server_id }}" id="server_id">
                  <label for="server_name" class="col-form-label">Nazwa serwera</label>
                  <input type="text" name="server_name" class="form-control settings2" id="server_name" value="{{ server_name }}">
                  <label for="server_ip" class="col-form-label">IP serwera</label>
                  <input type="text" name="server_ip" class="form-control settings2" id="server_ip" value="{{ server_ip }}">
                  <label for="rcon_password" class="col-form-label">Hasło rcon</label>
                  <input type="password" name="rcon_password" class="form-control settings2" id="rcon_password" autocomplete="new-password">
              </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Anuluj</button>
            <button type="button" class="btn btn-primary save-settings2">Zapisz</button>
          </div>
        </div>
      </div>
    </div>
{% endblock %}